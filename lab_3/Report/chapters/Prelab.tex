\section{Problem 1: Decibels}
\begin{enumerate}
    \item Given $x(t) = 5 \cos \left(2\pi 1000t\right)$
          \begin{itemize}
              \item What is the amplitude and the $V_{pp}$ of the signal?

                    The amplitude of the signal is $5V$ and the $V_{pp}$ is $2 \cdot 5V = 10V$.
              \item What is the $V_{rms}$ of the signal?

                    The $V_{rms}$ of a sinusoidal signal is given by
                    \begin{equation}
                        V_{rms} = \frac{V_A}{2\sqrt{2}} = \frac{5V}{\sqrt{2}} = 3.535V
                    \end{equation}
              \item What is the amplitude of the spectral peak in dBVrms?
                    The amplitude of the spectral peak in dBVrms is given by the following relation:
                    \begin{equation}
                        A_{dBV_{rms}} = 20 \log_{10} \left(V_{rms}\right) = 20 \log_{10} \left(3.535V\right) = 10.9dBV_{rms}
                    \end{equation}
          \end{itemize}
    \item Given a square wave of $1V_{pp}$ the voltage changes between -0.5V to 0.5V
          \begin{itemize}
              \item What is the signal amplitude in $V_{rms}$?
                    To find the RMS value of a square wave, the following relation is used:
                    \begin{equation}
                        V_{rms} = \sqrt{\frac{1}{T}\left[\int_{0}^{T}f(t)^2 dt\right]}
                    \end{equation}
                    The square wave can be specified as a piecewise function:
                    \begin{equation}
                        f(t) = \begin{cases}
                            -0.5 & \text{if } 0 \leq t \leq \frac{T}{2} \\
                            0.5  & \text{if } \frac{T}{2} \leq t \leq T
                        \end{cases}
                    \end{equation}
                    Performing the integral over the function,
                    \begin{equation}
                        \begin{gathered}
                            V_{rms} = \sqrt{\frac{1}{T}\left[
                                    \int_{0}^{T/2}(-0.5)^2 dt
                                    +
                                    \int_{T/2}^{T}(0.5)^2 dt
                                    \right]} \\
                            = \sqrt{0.25 \cdot \frac{1}{T}\left(\frac{T}{2} + T - \frac{T}{2}\right)} \\
                            = \sqrt{0.25}V \\
                            = 0.5V
                        \end{gathered}
                    \end{equation}
              \item What is the amplitude in dBVrms?
                    \begin{equation}
                        V_{dB_{rms}} = 20\log_{10}\left(V_{rms}\right) = 20\log_{10}\left(0.5V\right) = -6.02dBV_{rms}
                    \end{equation}
          \end{itemize}
\end{enumerate}
\section{Problem 2: Determination of Fourier Series Coefficients}
\begin{enumerate}
    \item Determine the Fourier series coefficients up to the 5th harmonic of the function $f(t) = 4t^2$

          To determine the fourier series coefficients, first recognize that the function is an even function by the very fact that it is a polynomial of an even degree. Knowing this, the relations used to compute the fourier series coefficients are:
          \begin{equation}
              \begin{gathered}
                  a_n = \frac{4}{T}\int_{-T}^{T}t^2 \cos(n\omega_0t) dt \\
                  a_0 = \frac{1}{T}\int_{0}^{T}t^2 dt \\
                  b_n = 0 \\
              \end{gathered}
          \end{equation}
          Where it is known that $T = 1$ due to the interval being given as $[-0.5, 0.5]$. Furthermore, $\omega_0 = \frac{2\pi}{T} = 2\pi$. By using the help of an integration table, the integral for $a_n$ is
          \begin{equation}
              a_n = 4\cdot \left[
                  \frac{2t \cos(n\omega_0t)}{4\pi^2n^2} + \frac{n^24\pi^2 - 2}{8\pi^3n^3}sin(n\omega_0t)
                  \right]_{-T}^{T}
          \end{equation}

          Evaluating this integral:
          \begin{equation}
              a_n = 4 \cdot \left(\frac{4 \cdot (-1)^n}{4\pi^2n^2}\right)
              = \frac{4 \cdot (-1)^n}{\pi^2n^2}
          \end{equation}

          For $a_0$, the integral is straightforward:
          \begin{equation}
              a_0 = \frac{1}{T}\int_{0}^{T}t^2 dt = \left[\frac{t^3}{3}\right]_{0}^{T} = \frac{1}{3}
          \end{equation}

          So the first five coefficients are:
          \begin{equation}
              a_n = \left\{ \frac{-4}{\pi^2}, \frac{4}{16\pi^2}, \frac{-4}{36\pi^2}, \frac{4}{64\pi^2}, \frac{-4}{100\pi^2} \right\}
          \end{equation}
    \item Use MATLAB to plot the original function and its fourier series up to the fifth harmonic. Put both graphs into the same diagram.
          \begin{figure}[H]
              \centering
              \includegraphics[width=0.8\textwidth]{images/prelab_problem_2_plot.png}
              \caption{The plot of the original function, and its fourier series leading up to the fifth harmonic}
          \end{figure}
\end{enumerate}

\newpage
\section{Problem 3: FFT of a Rectangular Wave}

\begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{images/prelab_problem_3_time.png}
    \caption{A figure showing the different rectangular waves based on their duty cycles. Plotted using MATLAB.}
\end{figure}

\begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{images/prelab_problem_3_freq.png}
    \caption{A figure showing the different rectangular waves' spectra based on their duty cycles. Plotted using MATLAB.}
\end{figure}
Following by the equation:

\begin{equation}
    c_k = \frac{1}{k\pi}\sin(k\omega_0T_1)
\end{equation}

It is observed that for a lower $T_1$, for each frequency component the amplitude of the component is lower. This is due to the fact that the pulse width is lower, and thus the signal is more spread out in the time domain. This is also observed in the frequency domain, where the frequency components are more spread out, thereby more frequency components are required to represent the signal.

\section{Problem 4: FFT of an audio file}

\begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{images/prelab_problem_4_time.png}
    \caption{A figure showing the plot of the audio file}
\end{figure}
\begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{images/prelab_problem_4_freq.png}
    \caption{A figure showing the frequency spectrum of the audio file}
\end{figure}

The following tones are observed:
\begin{itemize}
    \item G3 - 201Hz
    \item B4 - 503Hz
    \item E6 - 1308Hz
    \item A6 - 1812Hz
    \item E7 - 2617Hz
    \item A\#7 - 3826Hz
    \item D\#8 - 5034Hz
    \item G\#8 - 6645Hz
\end{itemize}

The MATLAB code for all of the prelab problems are provided in the appendix.